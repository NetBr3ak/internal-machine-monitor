<!DOCTYPE html>
<html lang="pl">

<head>
	<meta charset="UTF-8">
	<title>Dashboard Operatora</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
	<h1>Dashboard Operatora / Kierownika</h1>
	<h2>Maszyny</h2>
	<div class="machines">
		{% for machine in machines %}
		<div class="machine {{ machine.status }}">
			<h3>{{ machine.name }}</h3>
			<p>Status: {{ machine.status }}</p>
			<p>Zadanie: {{ machine.current_task or 'Brak' }}</p>
			<p>Czas do końca: {{ machine.time_left or 0 }} min</p>
			<button onclick="reportFailure({{ machine.id }})">Zgłoś awarię</button>
		</div>
		{% endfor %}
	</div>
	<h2>Zlecenia Produkcyjne</h2>
	<ul>
		{% for task in tasks %}
		<li>{{ task.name }} - Maszyna: {{ task.machine_id }} - Status: {{ task.status }}</li>
		{% endfor %}
	</ul>
	<h2>Historia Incydentów</h2>
	<ul>
		{% for failure in failures %}
		<li>{{ failure.description }} - {{ failure.reported_at }}</li>
		{% endfor %}
	</ul>
	<div id="failureModal" class="modal">
		<div class="modal-content">
			<span class="close">&times;</span>
			<h2>Zgłoś Awarię</h2>
			<form id="failureForm" action="/report_failure" method="post">
				<input type="hidden" name="machine_id" id="machineId">
				<label>Opis: <input type="text" name="description" required></label>
				<label>Typ: <input type="text" name="type" required></label>
				<label>Zdjęcie: <input type="file" name="image"></label>
				<button type="submit">Zgłoś</button>
			</form>
		</div>
	</div>
	<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>